function tnew = plan(x,y,z,a,b,c,t,target)
a123=38;a4=18;
dt = 0.01;d = 0.5;%连杆边长
l = 10;%基座边长
m = [1,1,1,0,0,0.5,50];
I00 = eye(3)*m(7)*l^2/6;
I01 = [m(1)*(d^2+d^2)/12,0,0;
    0,m(1)*(a123^2+d^2)/12+m(1)*(a123/2)^2,0;
    0,0,m(1)*(a123^2+d^2)/12+m(1)*(a123/2)^2];
I02 = [m(6)*(d^2+d^2)/12,0,0;
    0,m(6)*(a4^2+d^2)/12+m(6)*(a4/2)^2,0;
    0,0,m(6)*(a4^2+d^2)/12+m(6)*(a4/2)^2];
r = zeros(7,3);
r(7,:) = [x,y,z];
[~,T0,T1,T2,T3,T4,T5,T6] = spaceforward(r(7,1),r(7,2),r(7,3),a,b,c,t);
tmp = T0*[l/2;0;0;1];
p(1,:) = tmp(1:3);
tmp = T0*T1*[a;0;0;1];
p(2,:) = tmp(1:3);
tmp = T0*T1*T2*[a;0;0;1];
p(3,:) = tmp(1:3);
tmp = T0*T1*T2*T3*[a;0;0;1];
p(4,:) = tmp(1:3);
p(5,:) = p(4,:);
p(6,:) = p(4,:);
tmp = T0*T1*T2*T3*T4*T5*T6*[a4;0;0;1];
re = tmp(1:3);
r(1,:) = (p(1,:)+p(2,:))/2;
r(2,:) = (p(2,:)+p(3,:))/2;
r(3,:) = (p(4,:)+p(3,:))/2;
r(4,:) = (p(4,:)+p(5,:))/2;
r(5,:) = (p(6,:)+p(5,:))/2;
r(6,:) = (p(6,:)+re.')/2;
tmp = T0*T1*[0;0;1;1];
k(1,:) = tmp(1:3)-p(1,:).';
tmp = T0*T1*T2*[0;0;1;1];
k(2,:) = tmp(1:3)-p(2,:).';
tmp = T0*T1*T2*T3*[0;0;1;1];
k(3,:) = tmp(1:3)-p(3,:).';
tmp = T0*T1*T2*T3*T4*[0;0;1;1];
k(4,:) = tmp(1:3)-p(4,:).';
tmp = T0*T1*T2*T3*T4*T5*[0;0;1;1];
k(5,:) = tmp(1:3)-p(5,:).';
tmp = T0*T1*T2*T3*T4*T5*T6*[0;0;1;1];
k(6,:) = tmp(1:3)-p(6,:).';
R0 = T0(1:3,1:3);
R1 = T0(1:3,1:3)*T1(1:3,1:3);
R2 = T0(1:3,1:3)*T1(1:3,1:3)*T2(1:3,1:3);
R3 = T0(1:3,1:3)*T1(1:3,1:3)*T2(1:3,1:3)*T3(1:3,1:3);
R4 = T0(1:3,1:3)*T1(1:3,1:3)*T2(1:3,1:3)*T3(1:3,1:3)*T4(1:3,1:3);
R5 = T0(1:3,1:3)*T1(1:3,1:3)*T2(1:3,1:3)*T3(1:3,1:3)*T4(1:3,1:3)*T5(1:3,1:3);
R6 = T0(1:3,1:3)*T1(1:3,1:3)*T2(1:3,1:3)*T3(1:3,1:3)*T4(1:3,1:3)*T5(1:3,1:3)*T6(1:3,1:3);
I(7,:,:) = R0*I00*R0.';
I(1,:,:) = R1*I01*R1.';
I(2,:,:) = R2*I01*R2.';
I(3,:,:) = R3*I01*R3.';
I(4,:,:) = zeros(3,3);
I(5,:,:) = zeros(3,3);
I(6,:,:) = R6*I02*R6.';
[J,~] = Jacobbm(re,t,m,r,I,k,p,a,b,c);%jacob矩阵计算
ve = (target-re);
w0 = [0;0;0];
tv = J\[ve;w0];
for j = 1:3
    if abs(tv(j))>3
        tvg(j) = 3*tv(j)/abs(tv(j));
    else
        tvg(j) = tv(j);
    end
end%防止奇异发散
if max([tv(4),tv(5),tv(6)])>3
    tvg(4) = 5*tv(4)/norm([tv(4);tv(5);tv(6)]);
    tvg(5) = 5*tv(5)/norm([tv(4);tv(5);tv(6)]);
    tvg(6) = 5*tv(6)/norm([tv(4);tv(5);tv(6)]);
end
tnew = t+tvg*dt;
end
%fkine
function [positionofend,T0,T1,T2,T3,T4,T5,T6] = spaceforward(x,y,z,a,b,c,t)
a1=38;a2=38;a3=38;a4=18;
% T0 = [cos(a)*cos(b),cos(a)*sin(b)*sin(c)-sin(a)*cos(c),cos(a)*sin(b)*cos(c)+sin(a)*sin(c),x;
%     sin(a)*cos(b),sin(a)*sin(b)*sin(c)+cos(a)*cos(c),sin(a)*sin(b)*cos(c)-cos(a)*sin(c),y;
%     -sin(b),cos(b)*sin(c),cos(b)*cos(c),z;
%     0,0,0,1];
k = [a;b;c];
phi = norm(k);
if phi==0
    k = [0;0;0];
else
    k = k/norm(k);
end
R0 = cos(phi)*eye(3)+(1-cos(phi))*(k*k.')+sin(phi)*wave(k);
T0 = [R0(1,1),R0(1,2),R0(1,3),x;
    R0(2,1),R0(2,2),R0(2,3),y;
    R0(3,1),R0(3,2),R0(3,3),z;
    0,0,0,1];
T1 = [cos(t(1)),-sin(t(1)),0,20;
    sin(t(1)),cos(t(1)),0,0;
    0,0,1,0;
    0,0,0,1];
T2 = [cos(t(2)),-sin(t(2)),0,a1;
    0,0,1,0;
    -sin(t(2)),-cos(t(2)),0,0;
    0,0,0,1];
T3 = [cos(t(3)),-sin(t(3)),0,a2;
    sin(t(3)),cos(t(3)),0,0;
    0,0,1,0;
    0,0,0,1];
T4 = [cos(t(4)),-sin(t(4)),0,a3;
    0,0,1,0;
    -sin(t(4)),-cos(t(4)),0,0;
    0,0,0,1];
T5 = [cos(t(5)),-sin(t(5)),0,0;
    0,0,-1,0;
    sin(t(5)),cos(t(5)),0,0;
    0,0,0,1];
T6 = [cos(t(6)),-sin(t(6)),0,0;
    0,0,1,0;
    -sin(t(6)),-cos(t(6)),0,0;
    0,0,0,1];
P4 = [a4;0;0;1];
positionofend = T0*T1*T2*T3*T4*T5*T6*P4;
end
%Jacob
function [J2,Jbm] = Jacobbm(re,t,m,r,I,k,p,a,b,c)
%t(6)
%m(7) 第7个是基座
%r(7,3)
%I(7,3,3)
%k(6,3)
%p(6,3)
a1 = 38;
a2 = 38;
a3 = 38;
M = sum(m);
%计算质心坐标
rg = [0,0,0];
for i = 1:7
    rg = rg + r(i,:)*m(i);
end
rg = rg/M;

Ja = M*wave(rg)*wave(rg-r(7,:));
for i = 1:7
    tmp3 = zeros(3,3);
    for jj = 1:3
        for kk = 1:3
            tmp3(jj,kk) = I(i,jj,kk);
        end
    end
    Ja = Ja + tmp3 - m(i)*wave(r(i,:))*wave(r(i,:)-r(7,:));
end
Jb = zeros(3,6);
for i = 1:7
    tmp1 = zeros(3,6);
    tmp2 = zeros(3,6);
    if i == 7
    else
        for j = 1:i
            tmp1(:,j) = cross(k(j,:).',(r(i,:)-p(j,:)).');
            tmp2(:,j) = k(j,:).';
        end
    end
    tmp3 = zeros(3,3);
    for jj = 1:3
        for kk = 1:3
            tmp3(jj,kk) = I(i,jj,kk);
        end
    end
    Jb = Jb + m(i)*(wave(rg)-wave(r(i,:)))*tmp1-tmp3*tmp2;
end
Jw = inv(Ja)*Jb;
Jv = wave(rg-r(7,:))*Jw;
for i = 1:7
    tmp1 = zeros(3,6);
    if i == 7
    else
        for j = 1:i
            tmp1(:,j) = cross(k(j,:).',(r(i,:)-p(j,:)).');
        end
    end
    Jv = Jv - m(i)*tmp1/M;
end
Jbm = [Jv;Jw];
%Jb
tmp = -wave(re-r(7,:));
Jb = [1,0,0,tmp(1,1),tmp(1,2),tmp(1,3);
      0,1,0,tmp(2,1),tmp(2,2),tmp(2,3);
      0,0,1,tmp(3,1),tmp(3,2),tmp(3,3);
      0,0,0,1,0,0;
      0,0,0,0,1,0;
      0,0,0,0,0,1];
%Jm
t1 = t(1); t2 = t(2); t3 = t(3); t4 = t(4); t5 = t(5); t6 = t(6); 
k = [a;b;c]; phi = norm(k);
if phi==0
    k = [0;0;0];
    Jm = ...
        [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   - a1*sin(t1) - a3*cos(t2 + t3)*sin(t1) - a2*cos(t2)*sin(t1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                - a3*sin(t2 + t3)*cos(t1) - a2*cos(t1)*sin(t2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -a3*sin(t2 + t3)*cos(t1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                               0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               cos(t1)*(a1 + a2*cos(t2)) + a3*cos(t2 + t3)*cos(t1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                - a3*sin(t2 + t3)*sin(t1) - a2*sin(t1)*sin(t2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -a3*sin(t2 + t3)*sin(t1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                               0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                - a3*cos(t2 + t3) - a2*cos(t2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -a3*cos(t2 + t3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                               0;
     (sin(t2 + t3)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*cos(t6)*sin(t5))*(cos(t2 + t3)*cos(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - sin(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + sin(t2 + t3)*cos(t1)*cos(t6)*sin(t5)) - (sin(t2 + t3)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + cos(t2 + t3)*sin(t5)*sin(t6))*(sin(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - cos(t2 + t3)*cos(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + sin(t2 + t3)*cos(t1)*sin(t5)*sin(t6)) - (cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5))*(sin(t1)*sin(t4)*sin(t5) + sin(t2 + t3)*cos(t1)*cos(t5) + cos(t2 + t3)*cos(t1)*cos(t4)*sin(t5)),                                                                                                                                                                                                                                                                                                                                                                                                                           - sin(t1)*(cos(t2 + t3)*cos(t6)*sin(t5) - sin(t2 + t3)*sin(t4)*sin(t6) + sin(t2 + t3)*cos(t4)*cos(t5)*cos(t6))^2 - sin(t1)*(sin(t2 + t3)*cos(t6)*sin(t4) + cos(t2 + t3)*sin(t5)*sin(t6) + sin(t2 + t3)*cos(t4)*cos(t5)*sin(t6))^2 - sin(t1)*(cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5))^2,                                                                                                                                                                                                                                                                                                                                                                                                                           - sin(t1)*(cos(t2 + t3)*cos(t6)*sin(t5) - sin(t2 + t3)*sin(t4)*sin(t6) + sin(t2 + t3)*cos(t4)*cos(t5)*cos(t6))^2 - sin(t1)*(sin(t2 + t3)*cos(t6)*sin(t4) + cos(t2 + t3)*sin(t5)*sin(t6) + sin(t2 + t3)*cos(t4)*cos(t5)*sin(t6))^2 - sin(t1)*(cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5))^2,                                                                                                                                                                               (cos(t1)*cos(t4)*sin(t5) + cos(t2 + t3)*sin(t1)*sin(t4)*sin(t5))*(cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5)) - (cos(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*sin(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)))*(sin(t2 + t3)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*cos(t6)*sin(t5)) - (cos(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) - cos(t2 + t3)*sin(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)))*(sin(t2 + t3)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + cos(t2 + t3)*sin(t5)*sin(t6)),                                                                                                                                                       (cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5))*(sin(t2 + t3)*sin(t1)*sin(t5) + cos(t1)*cos(t5)*sin(t4) - cos(t2 + t3)*cos(t4)*cos(t5)*sin(t1)) + (sin(t2 + t3)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*cos(t6)*sin(t5))*(sin(t2 + t3)*cos(t5)*cos(t6)*sin(t1) - cos(t1)*cos(t6)*sin(t4)*sin(t5) + cos(t2 + t3)*cos(t4)*cos(t6)*sin(t1)*sin(t5)) - (sin(t2 + t3)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + cos(t2 + t3)*sin(t5)*sin(t6))*(sin(t2 + t3)*cos(t5)*sin(t1)*sin(t6) - cos(t1)*sin(t4)*sin(t5)*sin(t6) + cos(t2 + t3)*cos(t4)*sin(t1)*sin(t5)*sin(t6)), - sin(t1)*sin(t4)*sin(t5) - sin(t2 + t3)*cos(t1)*cos(t5) - cos(t2 + t3)*cos(t1)*cos(t4)*sin(t5);
     (sin(t2 + t3)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*cos(t6)*sin(t5))*(cos(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + cos(t2 + t3)*sin(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) + sin(t2 + t3)*cos(t6)*sin(t1)*sin(t5)) + (sin(t2 + t3)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + cos(t2 + t3)*sin(t5)*sin(t6))*(cos(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) + cos(t2 + t3)*sin(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) - sin(t2 + t3)*sin(t1)*sin(t5)*sin(t6)) - (cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5))*(sin(t2 + t3)*cos(t5)*sin(t1) - cos(t1)*sin(t4)*sin(t5) + cos(t2 + t3)*cos(t4)*sin(t1)*sin(t5)),                                                                                                                                                                                                                                                                                                                                                                                                                             cos(t1)*(cos(t2 + t3)*cos(t6)*sin(t5) - sin(t2 + t3)*sin(t4)*sin(t6) + sin(t2 + t3)*cos(t4)*cos(t5)*cos(t6))^2 + cos(t1)*(sin(t2 + t3)*cos(t6)*sin(t4) + cos(t2 + t3)*sin(t5)*sin(t6) + sin(t2 + t3)*cos(t4)*cos(t5)*sin(t6))^2 + cos(t1)*(cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5))^2,                                                                                                                                                                                                                                                                                                                                                                                                                             cos(t1)*(cos(t2 + t3)*cos(t6)*sin(t5) - sin(t2 + t3)*sin(t4)*sin(t6) + sin(t2 + t3)*cos(t4)*cos(t5)*cos(t6))^2 + cos(t1)*(sin(t2 + t3)*cos(t6)*sin(t4) + cos(t2 + t3)*sin(t5)*sin(t6) + sin(t2 + t3)*cos(t4)*cos(t5)*sin(t6))^2 + cos(t1)*(cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5))^2,                                                                                                                                                                               (cos(t4)*sin(t1)*sin(t5) - cos(t2 + t3)*cos(t1)*sin(t4)*sin(t5))*(cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5)) - (sin(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) + cos(t2 + t3)*cos(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)))*(sin(t2 + t3)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*cos(t6)*sin(t5)) - (sin(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + cos(t2 + t3)*cos(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)))*(sin(t2 + t3)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + cos(t2 + t3)*sin(t5)*sin(t6)),                                                                                                                                                       (cos(t2 + t3)*cos(t5) - sin(t2 + t3)*cos(t4)*sin(t5))*(cos(t5)*sin(t1)*sin(t4) - sin(t2 + t3)*cos(t1)*sin(t5) + cos(t2 + t3)*cos(t1)*cos(t4)*cos(t5)) - (sin(t2 + t3)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*cos(t6)*sin(t5))*(sin(t2 + t3)*cos(t1)*cos(t5)*cos(t6) + cos(t6)*sin(t1)*sin(t4)*sin(t5) + cos(t2 + t3)*cos(t1)*cos(t4)*cos(t6)*sin(t5)) + (sin(t2 + t3)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + cos(t2 + t3)*sin(t5)*sin(t6))*(sin(t2 + t3)*cos(t1)*cos(t5)*sin(t6) + sin(t1)*sin(t4)*sin(t5)*sin(t6) + cos(t2 + t3)*cos(t1)*cos(t4)*sin(t5)*sin(t6)),   cos(t1)*sin(t4)*sin(t5) - sin(t2 + t3)*cos(t5)*sin(t1) - cos(t2 + t3)*cos(t4)*sin(t1)*sin(t5);
                                                                                                                                                                                                                                         (sin(t1)*sin(t4)*sin(t5) + sin(t2 + t3)*cos(t1)*cos(t5) + cos(t2 + t3)*cos(t1)*cos(t4)*sin(t5))^2 + (cos(t2 + t3)*cos(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - sin(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + sin(t2 + t3)*cos(t1)*cos(t6)*sin(t5))^2 + (sin(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - cos(t2 + t3)*cos(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + sin(t2 + t3)*cos(t1)*sin(t5)*sin(t6))^2, (sin(t2 + t3)*sin(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + cos(t2 + t3)*sin(t1)*sin(t5)*sin(t6))*(sin(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - cos(t2 + t3)*cos(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + sin(t2 + t3)*cos(t1)*sin(t5)*sin(t6)) - (sin(t2 + t3)*sin(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*cos(t6)*sin(t1)*sin(t5))*(cos(t2 + t3)*cos(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - sin(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + sin(t2 + t3)*cos(t1)*cos(t6)*sin(t5)) + (cos(t2 + t3)*cos(t5)*sin(t1) - sin(t2 + t3)*cos(t4)*sin(t1)*sin(t5))*(sin(t1)*sin(t4)*sin(t5) + sin(t2 + t3)*cos(t1)*cos(t5) + cos(t2 + t3)*cos(t1)*cos(t4)*sin(t5)), (sin(t2 + t3)*sin(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + cos(t2 + t3)*sin(t1)*sin(t5)*sin(t6))*(sin(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - cos(t2 + t3)*cos(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + sin(t2 + t3)*cos(t1)*sin(t5)*sin(t6)) - (sin(t2 + t3)*sin(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*cos(t6)*sin(t1)*sin(t5))*(cos(t2 + t3)*cos(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - sin(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + sin(t2 + t3)*cos(t1)*cos(t6)*sin(t5)) + (cos(t2 + t3)*cos(t5)*sin(t1) - sin(t2 + t3)*cos(t4)*sin(t1)*sin(t5))*(sin(t1)*sin(t4)*sin(t5) + sin(t2 + t3)*cos(t1)*cos(t5) + cos(t2 + t3)*cos(t1)*cos(t4)*sin(t5)), (cos(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) - cos(t2 + t3)*sin(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)))*(sin(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - cos(t2 + t3)*cos(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + sin(t2 + t3)*cos(t1)*sin(t5)*sin(t6)) - (cos(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - cos(t2 + t3)*sin(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)))*(cos(t2 + t3)*cos(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - sin(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + sin(t2 + t3)*cos(t1)*cos(t6)*sin(t5)) - sin(t5)*(cos(t1)*cos(t4) + cos(t2 + t3)*sin(t1)*sin(t4))*(sin(t1)*sin(t4)*sin(t5) + sin(t2 + t3)*cos(t1)*cos(t5) + cos(t2 + t3)*cos(t1)*cos(t4)*sin(t5)), cos(t6)*(cos(t2 + t3)*cos(t1)*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - sin(t1)*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + sin(t2 + t3)*cos(t1)*cos(t6)*sin(t5))*(sin(t2 + t3)*cos(t5)*sin(t1) - cos(t1)*sin(t4)*sin(t5) + cos(t2 + t3)*cos(t4)*sin(t1)*sin(t5)) - (sin(t1)*sin(t4)*sin(t5) + sin(t2 + t3)*cos(t1)*cos(t5) + cos(t2 + t3)*cos(t1)*cos(t4)*sin(t5))*(sin(t2 + t3)*sin(t1)*sin(t5) + cos(t1)*cos(t5)*sin(t4) - cos(t2 + t3)*cos(t4)*cos(t5)*sin(t1)) + sin(t6)*(sin(t1)*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - cos(t2 + t3)*cos(t1)*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + sin(t2 + t3)*cos(t1)*sin(t5)*sin(t6))*(sin(t2 + t3)*cos(t5)*sin(t1) - cos(t1)*sin(t4)*sin(t5) + cos(t2 + t3)*cos(t4)*sin(t1)*sin(t5)),                                             sin(t2 + t3)*cos(t4)*sin(t5) - cos(t2 + t3)*cos(t5)];
    
else
    k = k/norm(k);
    Jm  = ...
        [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        - (cos(phi) - (a^2*(cos(phi) - 1))/phi^2)*(a1*sin(t1) + a2*cos(t2)*sin(t1)) - a3*(cos(t2 + t3)*sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - cos(t1)*(a1 + a2*cos(t2))*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            a2*sin(t1)*sin(t2)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) - a2*cos(t2)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - a3*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - a2*cos(t1)*sin(t2)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -a3*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;
        a3*(cos(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - (a1*sin(t1) + a2*cos(t2)*sin(t1))*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) + cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)*(a1 + a2*cos(t2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            a2*cos(t2)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) - a3*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - a2*cos(t1)*sin(t2)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - a2*sin(t1)*sin(t2)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -a3*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;
        (a1*sin(t1) + a2*cos(t2)*sin(t1))*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + a3*(cos(t2 + t3)*cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + cos(t1)*(a1 + a2*cos(t2))*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            a2*cos(t1)*sin(t2)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - a2*cos(t2)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - a3*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - a2*sin(t1)*sin(t2)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -a3*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;
        (cos(t5)*(sin(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*(cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(cos(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(cos(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(sin(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2))) - ((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(cos(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - (cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + cos(t6)*sin(t5)*(sin(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2))), ((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) + (cos(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))), ((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) + (cos(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))), ((sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - ((sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) + (cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) + (cos(t4)*sin(t5)*(sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) - sin(t4)*sin(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))), (cos(t5)*sin(t4)*(sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) - sin(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + cos(t4)*cos(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - ((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*(cos(t5)*cos(t6)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t4)*sin(t5)*(sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) + cos(t4)*cos(t6)*sin(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2))) - (cos(t5)*sin(t6)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*sin(t6)*(sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*sin(t6)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))),   ((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*((sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2))) - ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - (sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + cos(t6)*sin(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)));
        (cos(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*(sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(cos(t2 + t3)*sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*((sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(cos(t2 + t3)*sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) - ((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(cos(t2 + t3)*sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - (sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + cos(t6)*sin(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))), ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - sin(t5)*sin(t6)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - ((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) + (cos(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))), ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - sin(t5)*sin(t6)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - ((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) + (cos(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))), ((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) - (cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - ((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) - (cos(t4)*sin(t5)*(cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))), ((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*(cos(t5)*cos(t6)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t4)*sin(t5)*(cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) - cos(t4)*cos(t6)*sin(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) + (sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - cos(t5)*sin(t4)*(cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) + cos(t4)*cos(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*(sin(t4)*sin(t5)*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - cos(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))) + (cos(t5)*sin(t6)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*sin(t6)*(cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*sin(t6)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2))), - ((cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) - (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t5)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) + (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) - ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)) - (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(cos(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2) + sin(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*(cos(phi) - (c^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*cos(t1)*((b*sin(phi))/phi + (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*sin(t1)*((a*sin(phi))/phi - (b*c*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)));
        ((cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(cos(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(sin(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) + (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) - ((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(cos(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - (cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + cos(t6)*sin(t5)*(sin(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) + (cos(t5)*(sin(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*(cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*(cos(t2 + t3)*cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(cos(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*(cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))),                         ((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) + ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) + (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) + (cos(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(cos(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*(cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))),                         ((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) + ((cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) + (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) + (cos(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(cos(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*(cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))),                         (cos(t4)*sin(t5)*(sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) - sin(t4)*sin(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(cos(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*(cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) - ((sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6)) + (cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4))*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) - ((sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6)) + (cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6))*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) + (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))),                         (cos(t5)*sin(t6)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*sin(t6)*(sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) + cos(t4)*sin(t5)*sin(t6)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) + (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) - ((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*(cos(t5)*cos(t6)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + cos(t6)*sin(t4)*sin(t5)*(sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) + cos(t4)*cos(t6)*sin(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2))) + (cos(t5)*sin(t4)*(sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2)) - sin(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + cos(t4)*cos(t5)*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*(cos(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t4)*sin(t5)*(cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2)) - cos(t4)*sin(t5)*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))),                   ((sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) - (sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + cos(t6)*sin(t5)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))*((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) + (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2))) + ((cos(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2) + sin(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2))*(cos(t4)*sin(t6) + cos(t5)*cos(t6)*sin(t4)) + (sin(t4)*sin(t6) - cos(t4)*cos(t5)*cos(t6))*(sin(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)) - cos(t6)*sin(t5)*(cos(t2 + t3)*((b*sin(phi))/phi - (a*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*(cos(phi) - (a^2*(cos(phi) - 1))/phi^2) - sin(t2 + t3)*sin(t1)*((c*sin(phi))/phi + (a*b*(cos(phi) - 1))/phi^2)))*((sin(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2) - cos(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2))*(cos(t4)*cos(t6) - cos(t5)*sin(t4)*sin(t6)) - (cos(t6)*sin(t4) + cos(t4)*cos(t5)*sin(t6))*(sin(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) + cos(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)) + sin(t5)*sin(t6)*(sin(t2 + t3)*sin(t1)*(cos(phi) - (b^2*(cos(phi) - 1))/phi^2) - cos(t2 + t3)*((a*sin(phi))/phi + (b*c*(cos(phi) - 1))/phi^2) + sin(t2 + t3)*cos(t1)*((c*sin(phi))/phi - (a*b*(cos(phi) - 1))/phi^2)))];
    
end
J = Jb*Jbm+Jm;
Jmv = J(1:3,:);
J2 = [Jmv;Jw];
end
%wave
function rwave=wave(r)
rwave=[   0,  -r(3),   r(2);
       r(3),      0,  -r(1);
      -r(2),   r(1),     0];
end